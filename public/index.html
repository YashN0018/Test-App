<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Module1 - Data Ingestion Demo</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    label { display:block; margin-top:12px; }
    textarea { width:100%; height:80px; }
    input, select { width: 100%; padding:6px; }
    button { margin-top:12px; padding:8px 12px; }
    pre { background:#f6f6f6; padding:12px; }
  </style>
</head>
<body>
  <h2>Module 1 â€” Data Ingestion and Sync (Demo)</h2>

  <label>Client Name (required)
    <input id="clientName" value="Acme Corp" />
  </label>

  <label>Primary Contact (required)
    <input id="primaryContact" value="jane.doe@acme.com" />
  </label>

  <label>Industry (required)
    <input id="industry" value="Manufacturing" />
  </label>

  <label>Company Overview (required)
    <textarea id="companyOverview">Acme Corp is a manufacturer of widgets...</textarea>
  </label>

  <label>Client Status
    <select id="status">
      <option>Lead</option>
      <option>Active</option>
      <option>Dormant</option>
    </select>
  </label>

  <label>Dossier Version Status
    <select id="versionStatus">
      <option>Draft</option>
      <option>Submitted</option>
      <option>TL Approved</option>
      <option>Locked</option>
    </select>
  </label>

  <button id="submitBtn">Submit to /api/ingest</button>

  <h3>Response</h3>
  <pre id="output">No response yet.</pre>

  <script>
    // Demo frontend: build JSON payload and POST to /api/ingest
    document.getElementById('submitBtn').addEventListener('click', async () => {
      const payload = {
        client: {
          clientName: document.getElementById('clientName').value,
          primaryContact: document.getElementById('primaryContact').value,
          industry: document.getElementById('industry').value,
          status: document.getElementById('status').value,
          createdBy: 'demoUser'
        },
        dossier: {
          companyOverview: document.getElementById('companyOverview').value,
          versionStatus: document.getElementById('versionStatus').value,
          createdBy: 'demoUser'
        }
      };

      const out = document.getElementById('output');
      out.textContent = 'Sending...';

      try {
        const resp = await fetch('/api/ingest', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await resp.json();
        out.textContent = JSON.stringify({ status: resp.status, data }, null, 2);
      } catch (err) {
        out.textContent = 'Error: ' + err.message;
      }
    });
  </script>
  <script>
const form = document.getElementById('ingestForm'); // use your actual form id
const responseBox = document.getElementById('responseBox'); // id for response area

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const data = {
    clientName: document.getElementById('clientName').value,
    primaryContact: document.getElementById('primaryContact').value,
    industry: document.getElementById('industry').value,
    companyOverview: document.getElementById('companyOverview').value,
    clientStatus: document.getElementById('clientStatus').value,
    dossierVersionStatus: document.getElementById('dossierVersionStatus').value
  };

  responseBox.textContent = 'Sending...';
  try {
    const r = await fetch('/api/ingest', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });
    const json = await r.json();
    if (r.ok) {
      // show a friendly message and formatted JSON
      responseBox.innerHTML = `<div><strong>Saved successfully.</strong></div>
        <div>Client ID: <code>${json.data.client.clientId}</code></div>
        <pre style="background:#f5f5f5;padding:10px;border:1px solid #ddd;overflow:auto;">${JSON.stringify(json.data, null, 2)}</pre>`;
    } else {
      responseBox.textContent = `Error: ${json.message || 'Unknown error'}`;
    }
  } catch (err) {
    responseBox.textContent = 'Network error: ' + err.message;
  }
});
</script>

</body>
</html>